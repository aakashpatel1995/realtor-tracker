<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Realtor Tracker Dashboard</title>
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ  Realtor Tracker Dashboard</h1>
      <p class="subtitle">Greater Toronto Area Real Estate Listings</p>
    </header>

    <div id="config-banner" class="config-banner">
      <p>Configure your Airtable connection to view statistics</p>
      <button id="showConfigBtn" class="btn btn-white">Configure Now</button>
    </div>

    <div id="config-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Airtable Configuration</h2>
        <div class="input-group">
          <label for="apiKey">Airtable API Key:</label>
          <input type="password" id="apiKey" placeholder="Enter your Airtable API key">
          <small>Get your API key from <a href="https://airtable.com/account" target="_blank">airtable.com/account</a></small>
        </div>
        <div class="input-group">
          <label for="baseId">Airtable Base ID:</label>
          <input type="text" id="baseId" placeholder="Enter your Base ID (starts with 'app')">
          <small>Find your Base ID in the <a href="https://airtable.com/api" target="_blank">Airtable API docs</a></small>
        </div>
        <div class="modal-actions">
          <button id="saveConfigBtn" class="btn btn-primary">Save & Load Data</button>
          <button id="cancelConfigBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <main>
      <section class="stats-section">
        <h2>Listing Statistics</h2>
        <div class="stats-grid">
          <div class="stat-card new-today">
            <div class="stat-icon">ğŸ“ˆ</div>
            <div class="stat-value" id="newToday">-</div>
            <div class="stat-label">New Today</div>
            <div class="stat-description">Listings added today</div>
          </div>
          <div class="stat-card new-week">
            <div class="stat-icon">ğŸ“Š</div>
            <div class="stat-value" id="newLast7Days">-</div>
            <div class="stat-label">Last 7 Days</div>
            <div class="stat-description">New listings this week</div>
          </div>
          <div class="stat-card new-weeks">
            <div class="stat-icon">ğŸ“…</div>
            <div class="stat-value" id="newLast7Weeks">-</div>
            <div class="stat-label">Last 7 Weeks</div>
            <div class="stat-description">New listings (49 days)</div>
          </div>
          <div class="stat-card sold">
            <div class="stat-icon">ğŸ·ï¸</div>
            <div class="stat-value" id="soldToday">-</div>
            <div class="stat-label">Sold/Delisted Today</div>
            <div class="stat-description">Removed from market</div>
          </div>
        </div>

        <div class="total-card">
          <div class="total-icon">ğŸ˜ï¸</div>
          <div class="total-content">
            <div class="total-value" id="totalActive">-</div>
            <div class="total-label">Total Active Listings</div>
          </div>
        </div>
      </section>

      <section class="breakdown-section">
        <h2>By Listing Type</h2>
        <div class="breakdown-grid">
          <div class="breakdown-card">
            <h3>For Sale</h3>
            <div class="breakdown-value" id="saleCount">-</div>
            <div class="breakdown-bar">
              <div class="breakdown-fill sale-fill" id="saleFill"></div>
            </div>
          </div>
          <div class="breakdown-card">
            <h3>For Rent</h3>
            <div class="breakdown-value" id="rentCount">-</div>
            <div class="breakdown-bar">
              <div class="breakdown-fill rent-fill" id="rentFill"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="history-section">
        <h2>Recent Activity</h2>
        <div id="historyTable" class="history-table">
          <div class="history-loading">Loading history...</div>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-content">
        <div class="last-update">
          Last updated: <span id="lastUpdate">Never</span>
        </div>
        <div class="auto-refresh">
          <label>
            <input type="checkbox" id="autoRefresh" checked>
            Auto-refresh every 5 minutes
          </label>
        </div>
        <button id="refreshBtn" class="btn btn-primary">
          <span id="refreshText">Refresh Now</span>
          <span id="refreshSpinner" class="spinner hidden"></span>
        </button>
        <button id="settingsBtn" class="btn btn-secondary">âš™ï¸ Settings</button>
      </div>
    </footer>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="dashboard.js"></script>
</body>
</html>
